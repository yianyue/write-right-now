<div class="container">

<!-- TODO: Update User Goal -->
<div ng-controller="UserCtrl as user">
  <h2>{{ $root.currentUser.name }}'s Entries </h2>

  <p>Daily goal: {{ $root.currentUser.goal }} words
  <span class="input-btn">
    <button class="btn" aria-pressed="false" autocomplete="off" aria-label="Edit"
    data-toggle="collapse" data-target="#goalInput" aria-expanded="false" aria-controls="goalInput">Change Goal</button>
  </span>
  </p>

  <div class="collapse" id="goalInput">
    <div class="well">
      <form name="goal" class="form-inline" ng-model-options="{ updateOn: 'blur' }">
        <label for="goal">Goal</label>
        <input name="goal"
              class="form-control" 
              ng-model="user.info.goal"
              ng-change="user.updateGoal()">
      </form>
    </div>
  </div>
</div>

<div class="list-group" ng-repeat="day in main.days | orderBy:'date':true">

  <div ng-show="(day.entry && day.entry.word_count) || $index == 0">
    <a class="list-group-item" ng-href="#/entries/{{ day.entry.id }}">
    <h4 class="list-group-item-heading">{{ day.date | date:"MMM d, y" }}</h4>
    <div class="progress">
      <div class="progress-bar progress-bar-info" role="progressbar" aria-valuenow="20" aria-valuemin="0" aria-valuemax="100" style="width: {{ day.entry.word_count >= day.entry.goal ? 100 : day.entry.word_count/day.entry.goal*100 }}%">
      <span>{{ day.entry.word_count }}/{{ day.entry.goal }}</span> words
      </div>
    </div>
    <!-- not using handlebars here to display html -->
    <p class="text-muted">
      <span ng-bind-html="day.entry.content | limitTo: main.previewLimit"></span>
      {{day.entry.content.length >= main.previewLimit ? '...' : ''}}
    </p>
    </a>
  </div><!-- ng-show -->

  <div ng-hide="(day.entry && day.entry.word_count) || $index == 0" class="list-group-item">
    <h4 class="list-group-item-heading">{{ day.date | date:"MMM d, y" }}</h4>
    <div class="progress">
      <div class="progress-bar progress-bar-info" role="progressbar" aria-valuenow="20" aria-valuemin="0" aria-valuemax="100" style="width: 0%">
      <span>0</span> words
      </div>
    </div>
  </div><!-- ng-hide -->


</div>
  
</div>